# üìß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü-6: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email –∫–æ–¥–æ–º

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –û–±–Ω–æ–≤–ª—ë–Ω AuthContext
–§–∞–π–ª: `src/contexts/AuthContext.tsx`

–î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:
- `signUpWithEmail(email, fullName)` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ OTP –∫–æ–¥–∞ –Ω–∞ email
- `verifyEmailCode(email, token)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–≤–µ–¥—ë–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

### 2. –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç EmailVerificationDialog
–§–∞–π–ª: `src/components/EmailVerificationDialog.tsx`

–î–∏–∞–ª–æ–≥ —Å:
- InputOTP (–≥–æ—Ç–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è 6-–∑–Ω–∞—á–Ω–æ–≥–æ –∫–æ–¥–∞)
- –ö–Ω–æ–ø–∫–∏ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å" –∏ "–û—Ç–º–µ–Ω–∞"
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —É—Å–ø–µ—Ö–∞

### 3. –°–æ–∑–¥–∞–Ω–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
–§–∞–π–ª: `src/pages/TestEmailVerification.tsx`
–†–æ—É—Ç: `/test-email-verification`

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –°–ø–æ—Å–æ–± 1: –õ–æ–∫–∞–ª—å–Ω—ã–π Supabase (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π Supabase

```bash
npm run supabase:start
```

‚úÖ –≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å Supabase, –≤–∫–ª—é—á–∞—è **Inbucket** (–ª–æ–∫–∞–ª—å–Ω—ã–π email —Å–µ—Ä–≤–µ—Ä).

#### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä

```bash
npm run dev
```

#### –®–∞–≥ 3: –û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞: **http://localhost:5173/test-email-verification**

#### –®–∞–≥ 4: –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É

1. **–ò–º—è:** `–ò–≤–∞–Ω –¢–µ—Å—Ç–æ–≤—ã–π`
2. **Email:** `test@example.com` (–º–æ–∂–Ω–æ –ª—é–±–æ–π)
3. –ù–∞–∂–∞—Ç—å **"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –Ω–∞ email"**

#### –®–∞–≥ 5: –ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –∏–∑ Inbucket

–û—Ç–∫—Ä—ã—Ç—å: **http://localhost:8025** (Inbucket UI)

1. –í —Å–ø–∏—Å–∫–µ –ø–∏—Å–µ–º –Ω–∞–π—Ç–∏ –ø–∏—Å—å–º–æ –¥–ª—è `test@example.com`
2. –û—Ç–∫—Ä—ã—Ç—å –ø–∏—Å—å–º–æ
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å **6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥** –∏–∑ –ø–∏—Å—å–º–∞

#### –®–∞–≥ 6: –í–≤–µ—Å—Ç–∏ –∫–æ–¥

1. –í –¥–∏–∞–ª–æ–≥–µ "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ—á—Ç—ã" –≤–≤–µ—Å—Ç–∏ 6 —Ü–∏—Ñ—Ä
2. –ù–∞–∂–∞—Ç—å **"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"**
3. ‚úÖ –í—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã!

---

### –°–ø–æ—Å–æ–± 2: Supabase Cloud (—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π SMTP)

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–∏—Å—å–º–∞–º–∏ –Ω–∞ —Å–≤–æ—é –ø–æ—á—Ç—É:

#### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Custom SMTP –≤ Supabase Dashboard

–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞: https://supabase.com/dashboard

1. **Settings** ‚Üí **Auth** ‚Üí **SMTP Settings**
2. –í–∫–ª—é—á–∏—Ç—å **Enable Custom SMTP**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Gmail):
   ```
   Host: smtp.gmail.com
   Port: 587
   User: your-email@gmail.com
   Password: your-app-password (—Å–æ–∑–¥–∞—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Google)
   Sender email: your-email@gmail.com
   Sender name: ANDO JV
   ```

#### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Email Template

**Settings** ‚Üí **Auth** ‚Üí **Email Templates** ‚Üí **Magic Link**

```html
<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
    .code { font-size: 32px; font-weight: bold; color: #000; letter-spacing: 4px; }
    .container { background: #f9f9f9; padding: 30px; border-radius: 8px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ—á—Ç—ã</h2>
    <p>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!</p>
    <p>–ú—ã –ø–æ–ª—É—á–∏–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–∞—à–µ–π –ø–æ—á—Ç—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ <strong>andojv.com</strong>.</p>

    <p class="code">{{ .Token }}</p>

    <p>–í–≤–µ–¥–∏—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ—á—Ç—ã.</p>
    <p style="color: #666;">–ï—Å–ª–∏ —ç—Ç–æ –±—ã–ª–∏ –Ω–µ –≤—ã, —Ç–æ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ —ç—Ç–æ –ø–∏—Å—å–º–æ.</p>
  </div>
</body>
</html>
```

#### –®–∞–≥ 3: –ò–∑–º–µ–Ω–∏—Ç—å .env –Ω–∞ cloud

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ Supabase Dashboard
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_PUBLISHABLE_KEY=your-anon-key
```

#### –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä

```bash
npm run dev
```

#### –®–∞–≥ 5: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º email

1. –û—Ç–∫—Ä—ã—Ç—å `/test-email-verification`
2. –í–≤–µ—Å—Ç–∏ **—Å–≤–æ–π —Ä–µ–∞–ª—å–Ω—ã–π email**
3. –ù–∞–∂–∞—Ç—å "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥"
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á—Ç—É ‚Üí —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ ‚Üí –≤–≤–µ—Å—Ç–∏

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

### ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π flow

- [ ] –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: email –∏ –∏–º—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
- [ ] –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è toast "–ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!"
- [ ] –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ—á—Ç—ã"
- [ ] InputOTP –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã (6 —à—Ç—É–∫)
- [ ] –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å" –∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ 6 —Ü–∏—Ñ—Ä–∞—Ö
- [ ] –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚Üí toast "–£—Å–ø–µ—à–Ω–æ!" ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ header)

### ‚úÖ –ü–∏—Å—å–º–æ (Inbucket)

- [ ] –ü–∏—Å—å–º–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π email
- [ ] –¢–µ–º–∞ –ø–∏—Å—å–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
- [ ] –í –ø–∏—Å—å–º–µ –≤–∏–¥–µ–Ω 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
- [ ] –ö–æ–¥ –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å

### ‚úÖ –û—à–∏–±–∫–∏

- [ ] –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ ‚Üí toast "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥"
- [ ] –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–º–æ–∂–Ω–æ –Ω–∞–∂–∞—Ç—å "–û—Ç–º–µ–Ω–∞" –∏ –∑–∞–Ω–æ–≤–æ)
- [ ] –ï—Å–ª–∏ —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–í—ã —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã"

---

## üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–ª—è –¢–ó

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω—à–æ—Ç—ã:

1. **–§–æ—Ä–º–∞ –≤–≤–æ–¥–∞ email** (`/test-email-verification`)
2. **–î–∏–∞–ª–æ–≥ –≤–≤–æ–¥–∞ –∫–æ–¥–∞** (InputOTP —Å 6 —Å–ª–æ—Ç–∞–º–∏)
3. **–ü–∏—Å—å–º–æ –∏–∑ Inbucket** (—Å –∫–æ–¥–æ–º)
4. **–£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** (toast + header —Å email)

–≠—Ç–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –∏–∑ –¢–ó:
> **4 —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞** (—Å—Ç—Ä–æ–∫–∞ 247 –≤ –ü—Ä–∞–≤–∫–∏ 4 - refactored.md)

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü–∏—Å—å–º–æ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ Inbucket

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
docker ps | grep supabase
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
- `supabase-db`
- `supabase-auth`
- `supabase-inbucket`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
npm run supabase:stop
npm run supabase:start
```

### –û—à–∏–±–∫–∞ "Invalid API key"

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env:**
```bash
grep "VITE_SUPABASE" .env
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
VITE_SUPABASE_URL=http://localhost:8000
VITE_SUPABASE_PUBLISHABLE_KEY=eyJ...
```

### –ö–æ–¥ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ö–æ–¥ –∏—Å—Ç—ë–∫ (TTL = 1 —á–∞—Å)
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π email (–¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–µ–º, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏)
3. –û–ø–µ—á–∞—Ç–∫–∞ –≤ –∫–æ–¥–µ

**–†–µ—à–µ–Ω–∏–µ:**
–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –∑–∞–Ω–æ–≤–æ.

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É `/auth`
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ email" / "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –ø–∞—Ä–æ–ª–µ–º"
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å production SMTP (Resend/SendGrid)
4. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å Email Template —Å –±—Ä–µ–Ω–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º
5. ‚úÖ –£–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É `/test-email-verification`

---

**–ì–æ—Ç–æ–≤–æ! –ó–∞–ø—É—Å–∫–∞–π `npm run supabase:start` ‚Üí `npm run dev` ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–π `/test-email-verification` üöÄ**
